<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>CTFs | My Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Cybersecurity Blog">
<meta name="author" content="Joon Kim">
<link rel="canonical" href="http://localhost:1313/categories/ctfs/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/categories/ctfs/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/categories/ctfs/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="My Blog (Alt + H)">My Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    CTFs
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">BuckeyeCTF 2022 - pwn: ronin
    </h2>
  </header>
  <div class="entry-content">
    <p>References https://git.mbund.org/mbund/buckeyectf-2022/src/branch/main/writeups/ronin/ronin.md
Decompiled code After decompiling the binary, I was able to take a look at those major funtions that make up this program.
main():
int __cdecl main(int argc, const char **argv, const char **envp) { char shellcode_buffer[80]; // [rsp&#43;0h] [rbp-50h] BYREF setvbuf(_bss_start, 0LL, 2, 0LL); scroll(txt); fgets(shellcode_buffer, 80, stdin); if ( !strncmp(&#34;Chase after it.&#34;, shellcode_buffer, 15uLL) ) { scroll(off_4028); chase(); } scroll(off_4030); return 0; } scroll():
ize_t __fastcall scroll(const char *addr_to_some_buffer) { __useconds_t v1; // eax size_t result; // rax char single_char; // [rsp&#43;1Fh] [rbp-11h] size_t v4; // [rsp&#43;20h] [rbp-10h] size_t i; // [rsp&#43;28h] [rbp-8h] v4 = strlen(addr_to_some_buffer); for ( i = 0LL; ; &#43;&#43;i ) { result = i; if ( i &gt;= v4 ) break; single_char = addr_to_some_buffer[i]; // printing a single char from the string array putchar(single_char); if ( single_char == 10 ) v1 = 1000000; else v1 = 50000; usleep(v1); } return result; } encounter():
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to BuckeyeCTF 2022 - pwn: ronin" href="http://localhost:1313/posts/2022-11-30-ronin/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">BuckeyeCTF 2022 - pwn: samurai
    </h2>
  </header>
  <div class="entry-content">
    <p>BuckeyeCTF 2022 - pwn: samurai What I didn’t understand was the program inserts ./n which can be represented as 0x2ea. This is just a part of the string that it gets printed out to STDOUT. How this program works is it reads in some input from STDIN using fgets. fgets inserts a newline char after reading everything in (EOF or newline). But, if the input that I pass in to overflow the buffer that does not end with a newline char, then it will keep going (or being read) until it overflows the variable I want to overwrite. It can still work but there is this line of code strcpy(&amp;s[strlen(s) - 1], &#34;.\n&#34;); that puts a new line character at strlen(s) - 1. So, when I was naively giving an input that I would think should overwrite the variable, the last bit was always replaced by 2ea which is .\n. AH!!!!!!!!!!!! So, what we would want to do is at least have a newline char in the middle of the string so strcpy does not insert that .\n where the last bit is (this bit is still needed to be overwritten with some value to make the attack happen).
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to BuckeyeCTF 2022 - pwn: samurai" href="http://localhost:1313/posts/2022-11-29-samurai/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">diceCTF 2023 - pwn: bop
    </h2>
  </header>
  <div class="entry-content">
    <p>PWN: bop I didn’t get to solve this by my own but there were many interesting things that I wasn’t aware of that can be used to solve this challenge. However, I wanted to talk about a few things I got to know during the struggle of working on this challenge.
ret2dlresovle References: https://syst3mfailure.io/ret2dl_resolve https://ir0nstone.gitbook.io/notes/types/stack/ret2dlresolve When a binary uses the shared libraries by dynamically linking to them, they do not have (or know) all the addresses for those library functions as the program starts up. They would resolve this issue (finding the addresses of those functions) when the functions are actually called. And the trick in this technique is to force the dynamic linker to resolve (or relocate) all the addresses of the library functions as the program starts. The pwntools python library allows us to choose the functions of our choice and and use them as their addresses were already resolved.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to diceCTF 2023 - pwn: bop" href="http://localhost:1313/posts/2023-2-06-dicectf2023-pwn-bop/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">HackTheBox - Beginner Track: Blue
    </h2>
  </header>
  <div class="entry-content">
    <p>Challenge: Blue There wasn’t a description, so I ran nmap on the IP address that I was given:
PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-time: | date: 2023-04-30T01:23:49 |_ start_date: 2023-04-30T01:19:21 | smb2-security-mode: | 210: |_ Message signing enabled but not required | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\x00 | Workgroup: WORKGROUP\x00 |_ System time: 2023-04-30T02:23:51&#43;01:00 |_clock-skew: mean: -19m03s, deviation: 34m35s, median: 54s Port 135 was open, so I googled if there were any exploits regarding the msrpc service. I was able to find this article.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to HackTheBox - Beginner Track: Blue" href="http://localhost:1313/posts/2023-4-29-hackthebox-blue/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">HackTheBox: You know 0xDiablos
    </h2>
  </header>
  <div class="entry-content">
    <p>Description This is one of the challenges of the beginner track in HackTheBox.
I was given a binary with no source code. This indicated that I would need to use Ghidra to look at the decompiled source code. First, some checks on the binary:
─$ file ./vuln ./vuln: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=ab7f19bb67c16ae453d4959fba4e6841d930a6dd, for GNU/Linux 3.2.0, not stripped No defensive mechanisms are turned on for this challenge.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to HackTheBox: You know 0xDiablos" href="http://localhost:1313/posts/2023-3-13-hackthebox-you-know-0xdiablos/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">IA-32 Assembly
    </h2>
  </header>
  <div class="entry-content">
    <p>IA32 Assembly Language As I was working on picoCTF2021 - filtered-shellcode challenge, I realized that I need to write the shellcode in 32 bit assembly rather than in 64 bit. And compiling 32 bit assembly code is different than compiling 64 bit assembly code using gcc.
Great reference: https://academic.macewan.ca/boersn/images/quickref-20121215.pdf
First, to create an object file, use nasm.
nasm -f elf32 -o file.o file.s. This creates an object file file.o
Then link the object file with ld. The object file must have global _start.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to IA-32 Assembly" href="http://localhost:1313/posts/2022-5-27-ia32-assembly/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">LA CTF - pwn: bot
    </h2>
  </header>
  <div class="entry-content">
    <p>Description I made a bot to automatically answer all of your questions.
nc lac.tf 31180
My approach Again, the source code, its binary, and the Dockerfile were given. Looking at the sour code code:
#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;unistd.h&gt; int main(void) { setbuf(stdout, NULL); char input[64]; volatile int give_flag = 0; puts(&#34;hi, how can i help?&#34;); gets(input); if (strcmp(input, &#34;give me the flag&#34;) == 0) { puts(&#34;lol no&#34;); } else if (strcmp(input, &#34;please give me the flag&#34;) == 0) { puts(&#34;no&#34;); } else if (strcmp(input, &#34;help, i have no idea how to solve this&#34;) == 0) { puts(&#34;L&#34;); } else if (strcmp(input, &#34;may i have the flag?&#34;) == 0) { puts(&#34;not with that attitude&#34;); } else if (strcmp(input, &#34;please please please give me the flag&#34;) == 0) { puts(&#34;i&#39;ll consider it&#34;); sleep(15); if (give_flag) { puts(&#34;ok here&#39;s your flag&#34;); system(&#34;cat flag.txt&#34;); } else { puts(&#34;no&#34;); } } else { puts(&#34;sorry, i didn&#39;t understand your question&#34;); exit(1); } } After looking at the source code, I noticed that there is a give_flag variable and a buffer that we can overflow since the user input is received with gets(). Unlike the previous challenge I worked on, give_flag variable would always be located after the buffer input so we won’t be able to modify the value of give_flag this time.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to LA CTF - pwn: bot" href="http://localhost:1313/posts/2023-2-14-la-ctf-pwn-bot/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">LA CTF - pwn: gatekeep
    </h2>
  </header>
  <div class="entry-content">
    <p>Description If I gaslight you enough, you won’t be able to get my flag! :)
nc lac.tf 31121
Note: The attached binary is the exact same as the one executing on the remote server.
Source code The source code, its binary, and the Dockerfile were given. Looking at the sour code code:
#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; #include &lt;fcntl.h&gt; #include &lt;string.h&gt; void print_flag() { char flag[256]; FILE* flagfile = fopen(&#34;flag.txt&#34;, &#34;r&#34;); if (flagfile == NULL) { puts(&#34;Cannot read flag.txt.&#34;); } else { fgets(flag, 256, flagfile); flag[strcspn(flag, &#34;\n&#34;)] = &#39;\0&#39;; puts(flag); } } int check(){ char input[15]; char pass[10]; int access = 0; // If my password is random, I can gatekeep my flag! :) int data = open(&#34;/dev/urandom&#34;, O_RDONLY); if (data &lt; 0) { printf(&#34;Can&#39;t access /dev/urandom.\n&#34;); exit(1); } else { ssize_t result = read(data, pass, sizeof pass); if (result &lt; 0) { printf(&#34;Data not received from /dev/urandom\n&#34;); exit(1); } } close(data); printf(&#34;Password:\n&#34;); gets(input); if(strcmp(input, pass)) { printf(&#34;I swore that was the right password ...\n&#34;); } else { access = 1; } if(access) { printf(&#34;Guess I couldn&#39;t gaslight you!\n&#34;); print_flag(); } } int main(){ setbuf(stdout, NULL); printf(&#34;If I gaslight you enough, you won&#39;t be able to guess my password! :)\n&#34;); check(); return 0; } within check(), the password is being stored into a buffer using gets(). So I immediately thought that if I can control the return address of check() function to print_flag(), then we can get the flag. I checked the security properties of this binary by running pwn checksec --file=./gatekeep.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to LA CTF - pwn: gatekeep" href="http://localhost:1313/posts/2023-2-13-la-ctf-pwn-gatekeep/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">picoCTF - Scavenger Hunt
    </h2>
  </header>
  <div class="entry-content">
    <p>picoCTF: Scavenger Hunt Things I learned from this challenge:
Try to access those dot files! And other files that might be accessible other than the public ones.
robots.txt - https://developers.google.com/search/docs/advanced/robots/intro
Apache server manages its server permissions in .htaccess file.
It is always good to know what options I have to find vulnerabilities.
</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to picoCTF - Scavenger Hunt" href="http://localhost:1313/posts/2022-3-04-picoctf-scavenger-hunt/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">picoCTF 2020 - pwn: guessing game 1
    </h2>
  </header>
  <div class="entry-content">
    <p>References 1: https://mregraoncyber.com/picoctf-writeup-guessing-game-1/
2: https://github.com/dannyc-dev/Building-the-ROP-Chain
3: https://cyb3rwhitesnake.medium.com/picoctf-guessing-game-1-pwn-bdc1c87016f9
Investigation file ./vuln vuln: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, for GNU/Linux 3.2.0, BuildID[sha1]=94924855c14a01a7b5b38d9ed368fba31dfd4f60, not stripped This tells us that this executable contains all the libraries so we will be able to find a lot of gadgets if we have to find some.
Checksec result Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) PIE is disabled and NX is enabled so we won’t be able to execute anything by putting things onto the stack. We will need to do some ROP.
...</p>
  </div>
  <footer class="entry-footer">Joon Kim</footer>
  <a class="entry-link" aria-label="post link to picoCTF 2020 - pwn: guessing game 1" href="http://localhost:1313/posts/2022-12-27-guessing-game-1/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://localhost:1313/categories/ctfs/page/2/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">My Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
